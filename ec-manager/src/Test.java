import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.apache.poi.xssf.usermodel.XSSFRow;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

import com.sunmw.web.util.WebUtil;

public class Test {

	public static void main(String[] args) {
		String orderNos = "OD00564484,OD00564486,OD00564491,OD00564492,OD00564493,OD00564494,OD00564495,OD00564498,OD00564499,OD00564500,OD00564501,OD00564503,OD00564504,OD00564505,OD00564506,OD00564507,OD00564509,OD00564510,OD00564511,OD00564512,OD00564513,OD00564514,OD00564515,OD00564516,OD00564517,OD00564518,OD00564519,OD00564522,OD00564523,OD00564523,OD00564524,OD00564525,OD00564526,OD00564527,OD00564529,OD00564530,OD00564532,OD00564532,OD00564533,OD00564534,OD00564535,OD00564536,OD00564537,OD00564538,OD00564539,OD00564540,OD00564541,OD00564543,OD00564544,OD00564545,OD00564546,OD00564548,OD00564550,OD00564551,OD00564552,OD00564553,OD00564554,OD00564555,OD00564556,OD00564557,OD00564558,OD00564558,OD00564558,OD00564558,OD00564559,OD00564561,OD00564562,OD00564562,OD00564563,OD00564564,OD00564565,OD00564566,OD00564568,OD00564569,OD00564571,OD00564571,OD00564571,OD00564571,OD00564572,OD00564574,OD00564575,OD00564577,OD00564579,OD00564580,OD00564581,OD00564584,OD00564585,OD00564586,OD00564587,OD00564588,OD00564589,OD00564591,OD00564592,OD00564593,OD00564594,OD00564595,OD00564597,OD00564599,OD00564600,OD00564601,OD00564602,OD00564606,OD00564607,OD00564608,OD00564609,OD00564609,OD00564610,OD00564611,OD00564612,OD00564613,OD00564614,OD00564615,OD00564616,OD00564617,OD00564618,OD00564618,OD00564622,OD00564623,OD00564624,OD00564625,OD00564626,OD00564627,OD00564627,OD00564628,OD00564629,OD00564630,OD00564631,OD00564632,OD00564633,OD00564635,OD00564636,OD00564637,OD00564640,OD00564641,OD00564642,OD00564643,OD00564645,OD00564648,OD00564650,OD00564651,OD00564652,OD00564653,OD00564654,OD00564656,OD00564658,OD00564660,OD00564661,OD00564661,OD00564662,OD00564663,OD00564664,OD00564664,OD00564665,OD00564666,OD00564667,OD00564668,OD00564669,OD00564671,OD00564672,OD00564673,OD00564674,OD00564675,OD00564675,OD00564678,OD00564681,OD00564682,OD00564683,OD00564687,OD00564689,OD00564690,OD00564691,OD00564691,OD00564693,OD00564698,OD00564701,OD00564702,OD00564703,OD00564705,OD00564706,OD00564707,OD00564708,OD00564709,OD00564710,OD00564713,OD00564714,OD00564714,OD00564715,OD00564716,OD00564717,OD00564718,OD00564719,OD00564721,OD00564723,OD00564724,OD00564725,OD00564725,OD00564726,OD00564727,OD00564728,OD00564730,OD00564732,OD00564735,OD00564736,OD00564737,OD00564739,OD00564740,OD00564741,OD00564742,OD00564743,OD00564744,OD00564745,OD00564746,OD00564747,OD00564747,OD00564748,OD00564749,OD00564750,OD00564753,OD00564754,OD00564755,OD00564757,OD00564759,OD00564760,OD00564761,OD00564762,OD00564763,OD00564765,OD00564766,OD00564767,OD00564768,OD00564771,OD00564772,OD00564776,OD00564778,OD00564780,OD00564780,OD00564783,OD00564784,OD00564785,OD00564786,OD00564787,OD00564788,OD00564789,OD00564790,OD00564792,OD00564793,OD00564794,OD00564795,OD00564796,OD00564797,OD00564798,OD00564801,OD00564802,OD00564803,OD00564804,OD00564805,OD00564806,OD00564806,OD00564807,OD00564808,OD00564809,OD00564811,OD00564811,OD00564811,OD00564812,OD00564813,OD00564814,OD00564815,OD00564816,OD00564817,OD00564817,OD00564818,OD00564819,OD00564820,OD00564821,OD00564822,OD00564825,OD00564826,OD00564827,OD00564828,OD00564829,OD00564831,OD00564832,OD00564835,OD00564836,OD00564837,OD00564838,OD00564839,OD00564840,OD00564841,OD00564843,OD00564843,OD00564844,OD00564846,OD00564847,OD00564848,OD00564850,OD00564853,OD00564857,OD00564858,OD00564859,OD00564860,OD00564861,OD00564862,OD00564864,OD00564865,OD00564867,OD00564868,OD00564870,OD00564871,OD00564872,OD00564874,OD00564876,OD00564878,OD00564879,OD00564880,OD00564882,OD00564883,OD00564884,OD00564886,OD00564887,OD00564888,OD00564889,OD00564891,OD00564892,OD00564893,OD00564894,OD00564895,OD00564896,OD00564899,OD00564900,OD00564902,OD00564903,OD00564907,OD00564908,OD00564909,OD00564911,OD00564911,OD00564912,OD00564913,OD00564914,OD00564915,OD00564917,OD00564918,OD00564919,OD00564920,OD00564922,OD00564923,OD00564924,OD00564925,OD00564926,OD00564927,OD00564929,OD00564930,OD00564931,OD00564931,OD00564933,OD00564934,OD00564935,OD00564937,OD00564940,OD00564941,OD00564942,OD00564943,OD00564944,OD00564944,OD00564945,OD00564946,OD00564948,OD00564950,OD00564951,OD00564952,OD00564953,OD00564954,OD00564955,OD00564956,OD00564957,OD00564958,OD00564959,OD00564960,OD00564961,OD00564962,OD00564964,OD00564967,OD00564968,OD00564969,OD00564970,OD00564971,OD00564973,OD00564974,OD00564976,OD00564977,OD00564978,OD00564979,OD00564981,OD00564982,OD00564983,OD00564984,OD00564985,OD00564986,OD00564987,OD00564988,OD00564989,OD00564990,OD00564991,OD00564992,OD00564994,OD00564995,OD00564996,OD00565000,OD00565002,OD00565003,OD00565006,OD00565007,OD00565009,OD00565010,OD00565012,OD00565015,OD00565017,OD00565018,OD00565019,OD00565021,OD00565022,OD00565023,OD00565024,OD00565027,OD00565028,OD00565029,OD00565030,OD00565031,OD00565033,OD00565036,OD00565037,OD00565037,OD00565037,OD00565037,OD00565038,OD00565040,OD00565041,OD00565042,OD00565043,OD00565044,OD00565046,OD00565046,OD00565047,OD00565048,OD00565049,OD00565051,OD00565052,OD00565053,OD00565054,OD00565055,OD00565056,OD00565058,OD00565059,OD00565060,OD00565061,OD00565062,OD00565063,OD00565064,OD00565066,OD00565067,OD00565068,OD00565069,OD00565071,OD00565072,OD00565073,OD00565074,OD00565078,OD00565079,OD00565080,OD00565082,OD00565084,OD00565085,OD00565087,OD00565089,OD00565090,OD00565091,OD00565092,OD00565094,OD00565096,OD00565098,OD00565099,OD00565100,OD00565102,OD00565106,OD00565107,OD00565108,OD00565109,OD00565110,OD00565112,OD00565113,OD00565115,OD00565116,OD00565117,OD00565119,OD00565120,OD00565121,OD00565122,OD00565124,OD00565126,OD00565127,OD00565128,OD00565129,OD00565130,OD00565131,OD00565132,OD00565133,OD00565135,OD00565138,OD00565139,OD00565140,OD00565143,OD00565144,OD00565145,OD00565146,OD00565148,OD00565150,OD00565151,OD00565154,OD00565156,OD00565158,OD00565164,OD00565167,OD00565168,OD00565169,OD00565172,OD00565174,OD00565175,OD00565177,OD00565178,OD00565179,OD00565180,OD00565181,OD00565182,OD00565182,OD00565183,OD00565184,OD00565185,OD00565186,OD00565187,OD00565188,OD00565189,OD00565194,OD00565195,OD00565197,OD00565198,OD00565200,OD00565201,OD00565202,OD00565203,OD00565207,OD00565209,OD00565209,OD00565210,OD00565211,OD00565212,OD00565213,OD00565214,OD00565215,OD00565216,OD00565217,OD00565218,OD00565219,OD00565220,OD00565221,OD00565224,OD00565225,OD00565226,OD00565227,OD00565228,OD00565228,OD00565229,OD00565230,OD00565232,OD00565234,OD00565238,OD00565239,OD00565242,OD00565242,OD00565243,OD00565244,OD00565245,OD00565248,OD00565249,OD00565251,OD00565252,OD00565253,OD00565255,OD00565256,OD00565258,OD00565259,OD00565260,OD00565261,OD00565262,OD00565263,OD00565264,OD00565266,OD00565267,OD00565268,OD00565272,OD00565273,OD00565274,OD00565274,OD00565275,OD00565276,OD00565277,OD00565278,OD00565279,OD00565281,OD00565285,OD00565286,OD00565287,OD00565288,OD00565290,OD00565293,OD00565294,OD00565295,OD00565296,OD00565298,OD00565299,OD00565303,OD00565306,OD00565308,OD00565309,OD00565310,OD00565311,OD00565313,OD00565316,OD00565317,OD00565319,OD00565320,OD00565323,OD00565324,OD00565325,OD00565326,OD00565327,OD00565328,OD00565329,OD00565331,OD00565334,OD00565335,OD00565336,OD00565337,OD00565338,OD00565339,OD00565340,OD00565342,OD00565343,OD00565344,OD00565345,OD00565346,OD00565348,OD00565349,OD00565350,OD00565351,OD00565352,OD00565354,OD00565355,OD00565356,OD00565357,OD00565358,OD00565359,OD00565360,OD00565361,OD00565365,OD00565366,OD00565367,OD00565370,OD00565371,OD00565373,OD00565374,OD00565375,OD00565376,OD00565377,OD00565378,OD00565379,OD00565381,OD00565382,OD00565384,OD00565385,OD00565386,OD00565387,OD00565389,OD00565390,OD00565392,OD00565393,OD00565394,OD00565395,OD00565396,OD00565397,OD00565399,OD00565401,OD00565402,OD00565403,OD00565405,OD00565407,OD00565408,OD00565409,OD00565410,OD00565411,OD00565412,OD00565412,OD00565413,OD00565414,OD00565415,OD00565416,OD00565418,OD00565419,OD00565420,OD00565423,OD00565424,OD00565428,OD00565429,OD00565430,OD00565431,OD00565432,OD00565433,OD00565440,OD00565441,OD00565442,OD00565443,OD00565444,OD00565446,OD00565447,OD00565448,OD00565449,OD00565450,OD00565451,OD00565453,OD00565454,OD00565455,OD00565458,OD00565460,OD00565464,OD00565465,OD00565467,OD00565468,OD00565469,OD00565471,OD00565472,OD00565473,OD00565474,OD00565475,OD00565476,OD00565478,OD00565479,OD00565481,OD00565481,OD00565483,OD00565484,OD00565485,OD00565485,OD00565489,OD00565491,OD00565493,OD00565494,OD00565497,OD00565499,OD00565500,OD00565502,OD00565504,OD00565506,OD00565508,OD00565511,OD00565511,OD00565511,OD00565511,OD00565512,OD00565513";
		List<Object[]> l = WebUtil.readerCsv(new File("d://AMI_ECWH_DeliverNote_20121111113008.DAT"), false,"GBK");
		String[] on = orderNos.split(",");
		Map m = new HashMap();
		for(String o:on)
			m.put(o, o);
		List ll = new ArrayList();
		for(Object[] obj:l)
		{
			if(m.get(obj[2])!=null)
				continue;
			Map mm = new HashMap();
			for(int i=0;i<obj.length;i++)
				mm.put(""+i, obj[i]);
			ll.add(mm);
		}
		String[] h = new String[l.get(0).length];
		for(int i=0;i<h.length;i++)
			h[i] = ""+i;
		WebUtil.exportCSV(h, h, ll, "d://", "ss.DAT");
	}

	/**
	 * 
	 * 生成简单的Sheet
	 */

	void go() throws Exception {

		File tem = new File("D:/web server/apache-tomcat-6.0.33/webapps/data/financial/templete/taobao_financial_report_templete.xlsx");
		// 生成Excel文件的Workbook对象 （1）
		XSSFWorkbook wb = new XSSFWorkbook(new FileInputStream(tem));
		// 生成「sheet1」Sheet对象 （2）
		XSSFSheet sheet1 = wb.getSheetAt(0);
		// 生成行 （3）
		XSSFRow row0 = sheet1.getRow(2);
		// 生成列
		row0.getCell(2).setCellValue(111);
	
		// 把WorkBook对象打印到Excel文档
		FileOutputStream fileOut = new FileOutputStream("d:\\sample1.xlsx");
		wb.write(fileOut);
		fileOut.close();

	}

	public Map test(Map param) {
		System.out.println(param.get("StoreId"));
		Map result = new HashMap();
		result.put("Flag", "success");
		return result;
	}
}
